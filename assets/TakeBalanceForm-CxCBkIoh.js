import{k as S,r as c,j as t,J as o}from"./index-DXJC0gxo.js";import{P as j,F as m,S as f,a as v,b,c as N,d as w}from"./FormInput-jf5cEK0U.js";import{B as d}from"./button-Dl2RVhdx.js";import{u as C}from"./useMutation-9gywVg79.js";async function R(){try{const a=await S.get("/api/payments");return console.log(a),a.data}catch(a){throw console.error("خطأ :",a),new Error("خطأ أثناء جلب الدفعات")}}async function A({month:a,year:r}){try{return(await S.get(`/api/payments/month?month=${a}&year=${r}`)).data}catch(i){throw console.error("خطأ :",i),new Error("خطأ أثناء جلب الدفعات حسب الشهر")}}async function D({newPayment:a}){try{const r=await S.post("/api/payments/create",{newPayment:a});return console.log("تم إنشاء الدفعة:",r.data),r.data}catch(r){throw console.error("خطأ أثناء إنشاء الدفعة:",r),new Error("خطأ أثناء إنشاء الدفعة")}}function B({isOpen:a,setIsOpen:r,className:i}){const[s,h]=c.useState(0),[u,p]=c.useState(""),[n,x]=c.useState("USD"),[l,g]=c.useState(1),y=C({mutationFn:e=>D({newPayment:e}),onSuccess:()=>{o.success("تم اضافة الدفعة!"),r(!1)},onError:e=>{console.error(e),o.error("حدث خطأ اثناء الاضافة")}});return t.jsx("div",{children:t.jsx(j,{title:"اضافة دفعة للصندوق",trigger:t.jsx(d,{className:`${i}`,onClick:e=>{r(!0),e.stopPropagation()},variant:"accent",children:"قبض"}),isOpen:a,setIsOpen:r,children:t.jsxs("form",{className:"space-y-4 mt-4",onSubmit:e=>{if(e.preventDefault(),s<=0){o.error("الرجاء ادخال قيمة صحيحة للدفعة");return}if(n!=="USD"&&l<=0){o.error("الرجاء ادخال سعر صرف صحيح");return}if(u.trim()===""){o.error("الرجاء ادخال ملاحظة للدفعة");return}y.mutate({supplierId:"elidaher",amount:n=="USD"?s:Number((s/l).toFixed(1)),note:u,currency:n,exchangeRate:l,amount_base:s,type:"income"})},children:[t.jsx(m,{label:"قيمة الدفعة",id:"payment-amount",type:"text",value:s.toString(),onChange:e=>h(Number(e.target.value))}),t.jsx(m,{label:"ملاحظات",id:"note",type:"text",value:u,onChange:e=>p(e.target.value)}),t.jsxs(t.Fragment,{children:[t.jsxs(f,{value:n,onValueChange:x,children:[t.jsx(v,{className:"w-full mt-6",children:t.jsx(b,{placeholder:"العملة المدفوع بها"})}),t.jsx(N,{children:["SYP","USD"].map(e=>t.jsx(w,{value:e,children:e},e))})]}),t.jsx(m,{id:"exchangeRate",label:"سعر الصرف",value:n=="USD"?1:l,onChange:e=>g(Number(e.target.value)),disabled:n==="USD"})]}),t.jsx(d,{className:"w-full",type:"submit",children:"اتمام العملية"})]})})})}function k({isOpen:a,setIsOpen:r,className:i}){const[s,h]=c.useState(0),[u,p]=c.useState(""),[n,x]=c.useState("USD"),[l,g]=c.useState(1),y=C({mutationFn:e=>D({newPayment:e}),onSuccess:()=>{o.success("تم اضافة الدفعة!"),r(!1)},onError:e=>{console.error(e),o.error("حدث خطأ اثناء الاضافة")}});return t.jsx("div",{children:t.jsx(j,{title:"دفع من الصندوق",trigger:t.jsx(d,{className:`${i}`,onClick:e=>{r(!0),e.stopPropagation()},variant:"destructive",children:"دفع"}),isOpen:a,setIsOpen:r,children:t.jsxs("form",{className:"space-y-4 mt-4",onSubmit:e=>{if(e.preventDefault(),s<=0){o.error("الرجاء ادخال قيمة صحيحة للدفعة");return}if(n!=="USD"&&l<=0){o.error("الرجاء ادخال سعر صرف صحيح");return}if(u.trim()===""){o.error("الرجاء ادخال ملاحظة للدفعة");return}y.mutate({supplierId:"elidaher",amount:n=="USD"?-s:-Number((s/l).toFixed(1)),note:u,currency:n,exchangeRate:l,amount_base:-s,type:"expense"})},children:[t.jsx(m,{label:"قيمة الدفعة",id:"payment-amount",type:"text",value:s.toString(),onChange:e=>h(Number(e.target.value))}),t.jsx(m,{label:"ملاحظات",id:"note",type:"text",value:u,onChange:e=>p(e.target.value)}),t.jsxs(t.Fragment,{children:[t.jsxs(f,{value:n,onValueChange:x,children:[t.jsx(v,{className:"w-full mt-6",children:t.jsx(b,{placeholder:"العملة المدفوع بها"})}),t.jsx(N,{children:["SYP","USD"].map(e=>t.jsx(w,{value:e,children:e},e))})]}),t.jsx(m,{id:"exchangeRate",label:"سعر الصرف",onChange:e=>g(Number(e.target.value)),disabled:n==="USD"})]}),t.jsx(d,{className:"w-full",type:"submit",children:"اتمام العملية"})]})})})}export{B as A,k as T,R as a,A as g};
