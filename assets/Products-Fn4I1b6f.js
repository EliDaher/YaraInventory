import{c as T,j as e,r as s,u as q}from"./index-DcIbvTOY.js";import{S as B}from"./StatsCard-DQWkSaC6.js";import{D as L}from"./badge-DrEt5bay.js";import{A as N,T as R,P as A}from"./TransfareForm-Cw8ZHsoX.js";import{B as D}from"./button-Cb2WyCT8.js";import{C as I,a as M,b as E,c as V}from"./card-CT0aUM5P.js";import{S as H,a as K,b as Q,c as W,d as F,F as b}from"./FormInput-Cf-l-ZcN.js";import{L as Z}from"./Loading-ez3qyRtu.js";import{g as z}from"./products-4AxJp9CN.js";import"./loader-circle-BNOp1Uy_.js";import"./house-C7OyQAqL.js";import"./transaction-DBtGD_t8.js";import"./index-D6MabJr6.js";import"./SupplierSelect-BaCkSidV.js";import"./supplier-FEabGOru.js";import"./DataTable-CGEXJ95s.js";import"./table-CYfkhP9D.js";import"./input-B_UWbf6i.js";import"./search-jpMtFS4o.js";import"./PaymentTypeSelector-CKzwAiey.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=T("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);function v({DataToFilter:p,selectedFilter:i,setSelectedFilter:m,FilterBy:x,Placeholder:h}){return e.jsxs(H,{value:i,onValueChange:m,children:[e.jsx(K,{children:e.jsx(Q,{placeholder:h})}),e.jsxs(W,{children:[e.jsx(F,{value:"all",children:"الكل"},"all"),[...new Set(Object.values(p||{}).flatMap(r=>Object.values(r)).map(r=>{var c;return(c=r[x])==null?void 0:c.trim()}).filter(Boolean))].map(r=>e.jsx(F,{value:r,children:r},r))]})]})}function xe(){const[p,i]=s.useState(!1),[m,x]=s.useState({}),[h,r]=s.useState(!1),[c,w]=s.useState(null),[n,y]=s.useState("all"),[d,g]=s.useState("all"),[f,C]=s.useState("all"),[S,P]=s.useState(!1),[l,j]=s.useState([0,1e5]),{data:o,isLoading:O}=q({queryKey:["products-table"],queryFn:z}),u=s.useMemo(()=>{if(!o)return[];let t=Object.values(o).flatMap(a=>Object.values(a));return n!=="all"&&(t=t.filter(a=>a.warehouse===n)),d!=="all"&&(t=t.filter(a=>a.category===d)),f!=="all"&&(t=t.filter(a=>f==="out"?a.quantity===0:a.quantity>0&&a.quantity<5)),S&&(t=t.filter(a=>a.quantity<=5)),t=t.filter(a=>a.sellPrice>=l[0]&&a.sellPrice<=l[1]),t},[o,n,d,f,S,l]),k=u==null?void 0:u.reduce((t,a)=>t+(a.payPrice||1)*(a.quantity||1),0);return e.jsx(L,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{dir:"rtl",className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:e.jsx(B,{onClick:()=>{},title:"اجماري رصيد المنتجات",value:k.toFixed(2)||0,icon:G,onlyAdmin:!0})}),e.jsx(N,{isOpen:h,setIsOpen:r,row:c}),e.jsx(R,{isOpen:p,setIsOpen:i,row:m}),e.jsxs(I,{children:[e.jsx(M,{children:e.jsx(E,{children:"الفلاتر"})}),e.jsxs(V,{className:"grid gap-4",children:[e.jsx(v,{DataToFilter:o,selectedFilter:d,setSelectedFilter:g,FilterBy:"category",Placeholder:"اختر الصنف"}),e.jsx(v,{DataToFilter:o,selectedFilter:n,setSelectedFilter:y,FilterBy:"warehouse",Placeholder:"اختر المستودع"}),e.jsxs("div",{className:"flex w-full items-center gap-2",children:[e.jsx("span",{children:"السعر:"}),e.jsx(b,{label:"",type:"number",className:"border rounded px-2 py-1",value:l[0],onChange:t=>j([Number(t.target.value),l[1]]),placeholder:"min"}),"-",e.jsx(b,{label:"",type:"number",className:"border rounded px-2 py-1",value:l[1],onChange:t=>j([l[0],Number(t.target.value)]),placeholder:"max"})]}),e.jsx(D,{variant:"outline",onClick:()=>{y("all"),g("all"),C("all"),P(!1),j([0,1e5])},children:"إعادة تعيين الفلاتر"})]})]}),O?e.jsx(Z,{}):e.jsx(A,{productsData:u,setEditRow:w,setOpenForm:r,setOpenTransfare:i,setProductRow:x})]})})}export{xe as default};
