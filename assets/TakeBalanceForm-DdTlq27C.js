import{h as y,r as l,j as t}from"./index-H-wgWPw7.js";import{P as S,F as i,S as j,a as f,b as v,c as b,d as N}from"./FormInput-CFG--yAp.js";import{B as m}from"./button-CZhGKD8l.js";import{u as w}from"./badge-gArzQKeM.js";async function E(){try{const r=await y.get("/api/payments");return console.log(r),r.data}catch(r){throw console.error("خطأ :",r),new Error("خطأ أثناء جلب الدفعات")}}async function R({month:r,year:a}){try{return(await y.get(`/api/payments/month?month=${r}&year=${a}`)).data}catch(u){throw console.error("خطأ :",u),new Error("خطأ أثناء جلب الدفعات حسب الشهر")}}async function C({newPayment:r}){try{const a=await y.post("/api/payments/create",{newPayment:r});return console.log("تم إنشاء الدفعة:",a.data),a.data}catch(a){throw console.error("خطأ أثناء إنشاء الدفعة:",a),new Error("خطأ أثناء إنشاء الدفعة")}}function A({isOpen:r,setIsOpen:a,className:u}){const[s,d]=l.useState(0),[c,h]=l.useState(""),[n,p]=l.useState("USD"),[o,x]=l.useState(1),g=w({mutationFn:e=>C({newPayment:e}),onSuccess:()=>{alert("تم اضافة الدفعة!"),a(!1)},onError:e=>{console.error(e),alert("حدث خطأ اثناء الاضفة")}});return t.jsx("div",{children:t.jsx(S,{title:"اضافة دفعة للصندوق",trigger:t.jsx(m,{className:`${u}`,onClick:e=>{a(!0),e.stopPropagation()},variant:"accent",children:"قبض"}),isOpen:r,setIsOpen:a,children:t.jsxs("form",{className:"space-y-4 mt-4",onSubmit:e=>{if(e.preventDefault(),s<=0){alert("الرجاء ادخال قيمة صحيحة للدفعة");return}if(n!=="USD"&&o<=0){alert("الرجاء ادخال سعر صرف صحيح");return}if(c.trim()===""){alert("الرجاء ادخال ملاحظة للدفعة");return}g.mutate({supplierId:"elidaher",amount:n=="USD"?s:Number((s/o).toFixed(1)),note:c,currency:n,exchangeRate:o,amount_base:s,type:"income"})},children:[t.jsx(i,{label:"قيمة الدفعة",id:"payment-amount",type:"text",value:s.toString(),onChange:e=>d(Number(e.target.value))}),t.jsx(i,{label:"ملاحظات",id:"note",type:"text",value:c,onChange:e=>h(e.target.value)}),t.jsxs(t.Fragment,{children:[t.jsxs(j,{value:n,onValueChange:p,children:[t.jsx(f,{className:"w-full mt-6",children:t.jsx(v,{placeholder:"العملة المدفوع بها"})}),t.jsx(b,{children:["SYP","USD"].map(e=>t.jsx(N,{value:e,children:e},e))})]}),t.jsx(i,{id:"exchangeRate",label:"سعر الصرف",value:n=="USD"?1:o,onChange:e=>x(Number(e.target.value)),disabled:n==="USD"})]}),t.jsx(m,{className:"w-full",type:"submit",children:"اتمام العملية"})]})})})}function B({isOpen:r,setIsOpen:a,className:u}){const[s,d]=l.useState(0),[c,h]=l.useState(""),[n,p]=l.useState("USD"),[o,x]=l.useState(1),g=w({mutationFn:e=>C({newPayment:e}),onSuccess:()=>{alert("تم اضافة الدفعة!"),a(!1)},onError:e=>{console.error(e),alert("حدث خطأ اثناء الاضفة")}});return t.jsx("div",{children:t.jsx(S,{title:"دفع من الصندوق",trigger:t.jsx(m,{className:`${u}`,onClick:e=>{a(!0),e.stopPropagation()},variant:"destructive",children:"دفع"}),isOpen:r,setIsOpen:a,children:t.jsxs("form",{className:"space-y-4 mt-4",onSubmit:e=>{if(e.preventDefault(),s<=0){alert("الرجاء ادخال قيمة صحيحة للدفعة");return}if(n!=="USD"&&o<=0){alert("الرجاء ادخال سعر صرف صحيح");return}if(c.trim()===""){alert("الرجاء ادخال ملاحظة للدفعة");return}g.mutate({supplierId:"elidaher",amount:n=="USD"?-s:-Number((s/o).toFixed(1)),note:c,currency:n,exchangeRate:o,amount_base:-s,type:"expense"})},children:[t.jsx(i,{label:"قيمة الدفعة",id:"payment-amount",type:"text",value:s.toString(),onChange:e=>d(Number(e.target.value))}),t.jsx(i,{label:"ملاحظات",id:"note",type:"text",value:c,onChange:e=>h(e.target.value)}),t.jsxs(t.Fragment,{children:[t.jsxs(j,{value:n,onValueChange:p,children:[t.jsx(f,{className:"w-full mt-6",children:t.jsx(v,{placeholder:"العملة المدفوع بها"})}),t.jsx(b,{children:["SYP","USD"].map(e=>t.jsx(N,{value:e,children:e},e))})]}),t.jsx(i,{id:"exchangeRate",label:"سعر الصرف",onChange:e=>x(Number(e.target.value)),disabled:n==="USD"})]}),t.jsx(m,{className:"w-full",type:"submit",children:"اتمام العملية"})]})})})}export{A,B as T,E as a,R as g};
