import{n as y,r as c,a as S,j as t,B as m}from"./index-DedAuGlY.js";import{P as j,F as i}from"./FormInput-YgIorFMR.js";import{e as f,a as v,b,c as N,d as w}from"./select-Cfpajtue.js";async function U(){try{const r=await y.get("/api/payments");return console.log(r),r.data}catch(r){throw console.error("خطأ :",r),new Error("خطأ أثناء جلب الدفعات")}}async function E({month:r,year:a}){try{const o=await y.get(`/api/payments/month?month=${r}&year=${a}`);return console.log(o),o.data}catch(o){throw console.error("خطأ :",o),new Error("خطأ أثناء جلب الدفعات حسب الشهر")}}async function C({newPayment:r}){try{const a=await y.post("/api/payments/create",{newPayment:r});return console.log("تم إنشاء الدفعة:",a.data),a.data}catch(a){throw console.error("خطأ أثناء إنشاء الدفعة:",a),new Error("خطأ أثناء إنشاء الدفعة")}}function R({isOpen:r,setIsOpen:a,className:o}){const[s,d]=c.useState(0),[u,h]=c.useState(""),[n,x]=c.useState("USD"),[l,p]=c.useState(1),g=S({mutationFn:e=>C({newPayment:e}),onSuccess:()=>{alert("تم اضافة الدفعة!"),a(!1)},onError:e=>{console.error(e),alert("حدث خطأ اثناء الاضفة")}});return t.jsx("div",{children:t.jsx(j,{title:"اضافة دفعة للصندوق",trigger:t.jsx(m,{className:`${o}`,onClick:e=>{a(!0),e.stopPropagation()},variant:"accent",children:"قبض"}),isOpen:r,setIsOpen:a,children:t.jsxs("form",{className:"space-y-4 mt-4",onSubmit:e=>{if(e.preventDefault(),s<=0){alert("الرجاء ادخال قيمة صحيحة للدفعة");return}if(n!=="USD"&&l<=0){alert("الرجاء ادخال سعر صرف صحيح");return}if(u.trim()===""){alert("الرجاء ادخال ملاحظة للدفعة");return}g.mutate({supplierId:"elidaher",amount:n=="USD"?s:Number((s/l).toFixed(1)),note:u,currency:n,exchangeRate:l,amount_base:s,type:"income"})},children:[t.jsx(i,{label:"قيمة الدفعة",id:"payment-amount",type:"text",value:s.toString(),onChange:e=>d(Number(e.target.value))}),t.jsx(i,{label:"ملاحظات",id:"note",type:"text",value:u,onChange:e=>h(e.target.value)}),t.jsxs(t.Fragment,{children:[t.jsxs(f,{value:n,onValueChange:x,children:[t.jsx(v,{className:"w-full mt-6",children:t.jsx(b,{placeholder:"العملة المدفوع بها"})}),t.jsx(N,{children:["SYP","USD"].map(e=>t.jsx(w,{value:e,children:e},e))})]}),t.jsx(i,{id:"exchangeRate",label:"سعر الصرف",value:n=="USD"?1:l,onChange:e=>p(Number(e.target.value)),disabled:n==="USD"})]}),t.jsx(m,{className:"w-full",type:"submit",children:"اتمام العملية"})]})})})}function A({isOpen:r,setIsOpen:a,className:o}){const[s,d]=c.useState(0),[u,h]=c.useState(""),[n,x]=c.useState("USD"),[l,p]=c.useState(1),g=S({mutationFn:e=>C({newPayment:e}),onSuccess:()=>{alert("تم اضافة الدفعة!"),a(!1)},onError:e=>{console.error(e),alert("حدث خطأ اثناء الاضفة")}});return t.jsx("div",{children:t.jsx(j,{title:"دفع من الصندوق",trigger:t.jsx(m,{className:`${o}`,onClick:e=>{a(!0),e.stopPropagation()},variant:"destructive",children:"دفع"}),isOpen:r,setIsOpen:a,children:t.jsxs("form",{className:"space-y-4 mt-4",onSubmit:e=>{if(e.preventDefault(),s<=0){alert("الرجاء ادخال قيمة صحيحة للدفعة");return}if(n!=="USD"&&l<=0){alert("الرجاء ادخال سعر صرف صحيح");return}if(u.trim()===""){alert("الرجاء ادخال ملاحظة للدفعة");return}g.mutate({supplierId:"elidaher",amount:n=="USD"?-s:-Number((s/l).toFixed(1)),note:u,currency:n,exchangeRate:l,amount_base:-s,type:"expense"})},children:[t.jsx(i,{label:"قيمة الدفعة",id:"payment-amount",type:"text",value:s.toString(),onChange:e=>d(Number(e.target.value))}),t.jsx(i,{label:"ملاحظات",id:"note",type:"text",value:u,onChange:e=>h(e.target.value)}),t.jsxs(t.Fragment,{children:[t.jsxs(f,{value:n,onValueChange:x,children:[t.jsx(v,{className:"w-full mt-6",children:t.jsx(b,{placeholder:"العملة المدفوع بها"})}),t.jsx(N,{children:["SYP","USD"].map(e=>t.jsx(w,{value:e,children:e},e))})]}),t.jsx(i,{id:"exchangeRate",label:"سعر الصرف",onChange:e=>p(Number(e.target.value)),disabled:n==="USD"})]}),t.jsx(m,{className:"w-full",type:"submit",children:"اتمام العملية"})]})})})}export{R as A,A as T,U as a,C as c,E as g};
